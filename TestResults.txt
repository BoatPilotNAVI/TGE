Сценарий остановки/возобнавления продаж, ничего не попокупали на первой стадии, затем на второй стадии сразу перевели 1050000000 центов, проверили бонус, достигли Hard Cap,
успешно завершили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.onlyOneSecondStagePurchase, scenarioTypes.successFinished];

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1] (38ms)
  √ Владелец контрактов должен быть задан корректно (66ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (81ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (52ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (91ms)
  √ Кошелек для сбора средств должен быть задан корректно
  √ В кошельке для сбора средств должна быть 0 сумма
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (99ms)
  √ Проверка getWeiInCents
  √ Проверка getOneTokenInWei (38ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (99ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (76ms)
  √ Состояние до продаж - Prefunding (42ms)
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (51ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (54ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (45ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (40ms)
  √ Финализатор первой стадии должен сработать успешно (95ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (93ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $ (47ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageFunding (51ms)
  √ Переводы < 7 $ в состоянии SecondStageFunding не должны работать, перевод 6 $ (50ms)
  √ Переводы >= 7 $ в состоянии SecondStageFunding должны работать, перевод 1050000000 центов - бонус 20%, проверка полного выкупа с запасом (153ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageEnd (42ms)
  √ Финализатор второй стадии должен сработать успешно (145ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isSecondStageFinalized должа быть = true (46ms)
  √ На аккаунте советников должно быть 8040817 токенов
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов (45ms)
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты
  √ При запросе токенов на аккаунт команды должна возникать ошибка
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (69ms)
  √ На аккаунте команды должно быть 45947521 токенов

  43 passing (2s)
  
Сценарий остановки/возобнавления продаж, немного попокупали на первой стадии, проверили выдачу бонусов, затем на второй стадии, проверили бонусы, достигли Hard Cap,
успешно завершили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.secondStageHardCapReached, scenarioTypes.successFinished];

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (70ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (90ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (94ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (129ms)
  √ Кошелек для сбора средств должен быть задан корректно (76ms)
  √ В кошельке для сбора средств должна быть 0 сумма (69ms)
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (138ms)
  √ Проверка getWeiInCents
  √ Проверка getOneTokenInWei (74ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (85ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (108ms)
  √ Состояние до продаж - Prefunding (45ms)
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (51ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (65ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (49ms)
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 25 тыс. $ (274ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец (39ms)
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $
  √ Возобновить торги может только владелец (71ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (342ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ (318ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (293ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (300ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (38ms)
  √ Финализатор первой стадии должен сработать успешно (93ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (68ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $ (44ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов (48ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (61ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageFunding (60ms)
  √ Переводы < 7 $ в состоянии SecondStageFunding не должны работать, перевод 6 $ (51ms)
  √ Переводы >= 7 $ в состоянии SecondStageFunding должны работать, перевод 7 $, при условии кол-ва проданных токенов от [0-10%) - бонус 20% (305ms)
  √ Выкупаем все токены с 20% бонусом, 14071428 токенов - это 10% от кол-ва продаваемых токенов на второй стадии (372ms)
  √ Выкупаем все токены с 17.5% бонусом, с учетом бонусов состаит 14370820 токенов - это будет 20% от кол-ва продаваемых токенов на второй стадии (316ms)
  √ Выкупаем все токены с 15% бонусом, с учетом бонусов состаит 14683229 токенов - это будет 30% от кол-ва продаваемых токенов на второй стадии (283ms)
  √ Выкупаем все токены с 12.5% бонусом, с учетом бонусов состаит 15009523 токенов - это будет 40% от кол-ва продаваемых токенов на второй стадии (304ms)
  √ Выкупаем все токены с 10% бонусом, с учетом бонусов состаит 15350649 токенов - это будет 50% от кол-ва продаваемых токенов на второй стадии (314ms)
  √ Выкупаем все токены с 8% бонусом, с учетом бонусов состаит 15634920 токенов - это будет 60% от кол-ва продаваемых токенов на второй стадии (377ms)
  √ Выкупаем все токены с 6% бонусом, с учетом бонусов состаит 15929919 токенов - это будет 70% от кол-ва продаваемых токенов на второй стадии (313ms)
  √ Выкупаем все токены с 4% бонусом, с учетом бонусов состаит 16236263 токенов - это будет 80% от кол-ва продаваемых токенов на второй стадии (266ms)
  √ Выкупаем все токены с 2% бонусом, с учетом бонусов состаит 16554621 токенов - это будет 90% от кол-ва продаваемых токенов на второй стадии (284ms)
  √ Достигли Hard Cap (40ms)
  √ Переводы больше не должны приниматься в состоянии SecondStageFunding, т.к. набран Hard Cap (61ms)
  √ Финализатор второй стадии должен сработать успешно (225ms)
  √ Состояние, после выполнения финализатора второй стадии, в случае успеха должно быть Success, переменная isSecondStageFinalized должа быть = true, также isSuccessOver = true (70ms)
  √ На аккаунте контракта продаж, должно быть ровно столько токенов, сколько предусмотрено команде - 45947521 токенов
  √ Переводы в состоянии Success не должны работать, перевод 26 тыс. $
  √ Проверка, что собранные средства перевелись на кошелек для сборов, при этом сумма большая или равная Hard Cap переведена на нужный аккаунт (63ms)
  √ На аккаунте советников должно быть 8040817 токенов
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты (38ms)
  √ При запросе токенов на аккаунт команды должна возникать ошибка (86ms)
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (70ms)
  √ На аккаунте команды должно быть 45947521 токенов

  69 passing (8s)  
  
Сценарий остановки/возобнавления продаж, немного попокупали на первой стадии, сделали покупку через внешнюю функцию, проверили бонусы, затем не достигли Soft Cap, догнали на второй стадии методом preallocateSecondStage до Soft Cap,
успешно завершили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.checkExternalBuy, scenarioTypes.secondStageSoftCapNotReached, scenarioTypes.secondStagePreallocateToSoftCap, scenarioTypes.successFinished];  

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (83ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (78ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (116ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (125ms)
  √ Кошелек для сбора средств должен быть задан корректно (46ms)
  √ В кошельке для сбора средств должна быть 0 сумма
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (105ms)
  √ Проверка getWeiInCents (49ms)
  √ Проверка getOneTokenInWei (44ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (83ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (74ms)
  √ Состояние до продаж - Prefunding
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (52ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (53ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (57ms)
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 25 тыс. $ (290ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $ (44ms)
  √ Возобновить торги может только владелец (49ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (293ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов от владельца (249ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (274ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (272ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (41ms)
  √ Финализатор первой стадии должен сработать успешно (84ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (75ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов (40ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (71ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageFunding (46ms)
  √ Переводы < 7 $ в состоянии SecondStageFunding не должны работать, перевод 6 $ (46ms)
  √ Переводы >= 7 $ в состоянии SecondStageFunding должны работать, перевод 7 $, при условии кол-ва проданных токенов от [0-10%) - бонус 20% (283ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageEnd (41ms)
  √ Проверка догона до Soft Cap, с помощью функции preallocateSecondStage (151ms)
  √ Финализатор второй стадии должен сработать успешно (239ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isSecondStageFinalized должа быть = true (46ms)
  √ На аккаунте советников должно быть 8040817 токенов
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты
  √ При запросе токенов на аккаунт команды должна возникать ошибка (59ms)
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (71ms)
  √ На аккаунте команды должно быть 45947521 токенов

  58 passing (4s)

Сценарий остановки/возобнавления продаж, немного попокупали на первой стадии, проверили бонусы, затем не достигли Soft Cap, догнали на второй стадии методом preallocateSecondStage до Soft Cap,
успешно завершили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.firstStagePreallocate, scenarioTypes.secondStageSoftCapNotReached, scenarioTypes.secondStagePreallocateToSoftCap, scenarioTypes.successFinished];

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (65ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (57ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (75ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (162ms)
  √ Кошелек для сбора средств должен быть задан корректно (41ms)
  √ В кошельке для сбора средств должна быть 0 сумма
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (106ms)
  √ Проверка getWeiInCents
  √ Проверка getOneTokenInWei (44ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (109ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (78ms)
  √ Состояние до продаж - Prefunding (44ms)
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (49ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (56ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (62ms)
  √ Делаем preallocateFirstStage на 25 тыс. $, продали 535714.28 токенов (112ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $
  √ Возобновить торги может только владелец (43ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (269ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ (282ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (270ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (285ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (43ms)
  √ Финализатор первой стадии должен сработать успешно (76ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (90ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (63ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageFunding (57ms)
  √ Переводы < 7 $ в состоянии SecondStageFunding не должны работать, перевод 6 $ (67ms)
  √ Переводы >= 7 $ в состоянии SecondStageFunding должны работать, перевод 7 $, при условии кол-ва проданных токенов от [0-10%) - бонус 20% (269ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageEnd (43ms)
  √ Проверка догона до Soft Cap, с помощью функции preallocateSecondStage (124ms)
  √ Финализатор второй стадии должен сработать успешно (203ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isSecondStageFinalized должа быть = true (59ms)
  √ На аккаунте советников должно быть 8040817 токенов
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты
  √ При запросе токенов на аккаунт команды должна возникать ошибка (57ms)
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (66ms)
  √ На аккаунте команды должно быть 45947521 токенов

  58 passing (4s)

Сценарий остановки/возобнавления продаж, немного попокупали на первой стадии, проверили бонусы, затем не достигли Soft Cap, при финализации второй, провели возврат средств
также проверили, что при переводе с аккаунта на аккаунт полученных токенов (спекуляция), возврат производиться не будет
let scenario = [scenarioTypes.haltToggle, scenarioTypes.secondStageSoftCapNotReached, scenarioTypes.secondStageSoftCapNotReachedRefund];
  
  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (71ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (68ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (90ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (106ms)
  √ Кошелек для сбора средств должен быть задан корректно (40ms)
  √ В кошельке для сбора средств должна быть 0 сумма (68ms)
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (213ms)
  √ Проверка getWeiInCents (49ms)
  √ Проверка getOneTokenInWei (120ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (82ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (82ms)
  √ Состояние до продаж - Prefunding
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (50ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (62ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (74ms)
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 25 тыс. $ (295ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец (39ms)
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $
  √ Возобновить торги может только владелец (73ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (283ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ (262ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (276ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (321ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (47ms)
  √ Финализатор первой стадии должен сработать успешно (106ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (84ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов (40ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (63ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageFunding (59ms)
  √ Переводы < 7 $ в состоянии SecondStageFunding не должны работать, перевод 6 $ (45ms)
  √ Переводы >= 7 $ в состоянии SecondStageFunding должны работать, перевод 7 $, при условии кол-ва проданных токенов от [0-10%) - бонус 20% (310ms)
  √ ->Перевод 700 $ с 3 аккаунта для проверки последующего возврата (422ms)
  √ ->Перевод 700 $ с 4 аккаунта для проверки последующего возврата при спекуляциях токенами (292ms)
  √ Перевели время на 15 дней вперед
  √ Состояние, после изменения времени на 15 дней вперед, должно быть SecondStageEnd (61ms)
  √ Soft Cap не собрали, вызвали финализатор, финализатор второй стадии должен сработать успешно (63ms)
  √ Состояние, после выполнения финализатора первой стадии - Failure, переменная isSecondStageFinalized должа быть = true (129ms)
  √ Проверка перевода контракта продаж в режим возврата средств (121ms)
  √ <-Проверка возврата на 3 аккаунт (113ms)
  √ Переводим токены с 4-го аккаунта на 3-й (39ms)
  √ <-Проверка возврата на 4 аккаунт, возврат невозможен, т.к. был сторонний перевод и кол-во токенов на балансе контракта токена не совпадает с контрактом продаж

  55 passing (5s)

Сценарий остановки/возобнавления продаж, затем достигли Soft Cap на первой стадии, проверили бонусы, завершили вторую, успешно закончили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.firstStageSoftCapReached, scenarioTypes.secondStageSoftCapReached, scenarioTypes.successFinished];

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (66ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (54ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (77ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (90ms)
  √ Кошелек для сбора средств должен быть задан корректно
  √ В кошельке для сбора средств должна быть 0 сумма
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (95ms)
  √ Проверка getWeiInCents
  √ Проверка getOneTokenInWei (45ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (108ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (76ms)
  √ Состояние до продаж - Prefunding (39ms)
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (59ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (79ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (80ms)
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 25 тыс. $ (266ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $
  √ Возобновить торги может только владелец (40ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (303ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ (290ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (300ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (264ms)
  √ Выкуп всех токенов первой стадии и проверка того, что достигнут Soft Cap (325ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd (41ms)
  √ Финализатор первой стадии должен сработать успешно (85ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (56ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $ (40ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (57ms)
  √ Перевели время на 30 дней вперед
  √ Состояние, после изменения времени на 30 дней вперед, должно быть SecondStageEnd (48ms)
  √ Финализатор второй стадии должен сработать успешно (206ms)
  √ Состояние, после выполнения финализатора второй стадии, при достижении Soft Cap должно быть Success, переменная isSecondStageFinalized должа быть = true, также isSuccessOver = true (51ms)
  √ На аккаунте советников должно быть 8040817 токенов (39ms)
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты
  √ При запросе токенов на аккаунт команды должна возникать ошибка
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (77ms)
  √ На аккаунте команды должно быть 45947521 токенов

  54 passing (4s)

Сценарий остановки/возобнавления продаж, затем достигли Soft Cap на первой стадии, с помощью функции догона статы, проверили бонусы, завершили вторую, успешно закончили продажи
let scenario = [scenarioTypes.haltToggle, scenarioTypes.firstStagePreallocate, scenarioTypes.firstStageSoftCapReached, scenarioTypes.secondStageSoftCapReached, scenarioTypes.successFinished];

  √ Запуск
  √ Служебный вызов, перевод 1 эфира с адреса accounts[0] на accounts[1]
  √ Владелец контрактов должен быть задан корректно (78ms)
  √ Только контракт продаж может сжигать токены
  √ Только контракт продаж может создавать токены
  √ Даты начала и окончания первой стадии должны быть заданы корректно (68ms)
  √ Даты начала и окончания второй стадии должны быть заданы корректно (116ms)
  √ Наименование токена, символ, кол-во знаков, и тип токена должны быть заданы корректно (126ms)
  √ Кошелек для сбора средств должен быть задан корректно
  √ В кошельке для сбора средств должна быть 0 сумма
  √ На аккаунте советников, маркетинга, поддержки, команды не должно быть токенов (103ms)
  √ Проверка getWeiInCents
  √ Проверка getOneTokenInWei (76ms)
  √ Проверка setCurrentEtherRateInCents 40000 центов (74ms)
  √ Проверка setCurrentEtherRateInCents, возвращаем обратно, т.к. тесты были сделаны исходя из значения 33000 центов (81ms)
  √ Состояние до продаж - Prefunding
  √ Переводы в состоянии Prefunding не должны работать
  √ Перевели время на 2 дня вперед
  √ Состояние, после изменения времени на 2 дня вперед, должно быть FirstStageFunding (40ms)
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, всего должно находится 112000000 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на первой стадии, должно находится 112000000 токенов для продажи (54ms)
  √ Переводы < 25 тыс. $ в состоянии FirstStageFunding не должны работать, перевод 24 тыс. $ (45ms)
  √ Делаем preallocateFirstStage на 25 тыс. $, продали 535714.28 токенов (106ms)
  √ Токенов должно быть продано 535714.285714285714285714
  √ Остановить торги может только владелец (38ms)
  √ После вызовы halt(), у контракта продаж, переменная halted, должна быть установлена в true
  √ После экстренной остановки продаж, переводы эфира на контракт не должны работать, перевод 25 тыс. $
  √ Возобновить торги может только владелец (42ms)
  √ После вызовы unhalt(), у контракта продаж, переменная halted, должна быть установлена в false
  √ Переводы [25, 50) тыс. $ в состоянии FirstStageFunding - бонус 50%, перевод 49.9 тыс. $ (281ms)
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 75%, перевод 50 тыс. $ (302ms)
  √ Переводы перевод 50 тыс. $ через внешнюю функцию externalBuy, вызов не от владельца
  √ Переводы [50, 100) тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 99.9 тыс. $ (259ms)
  √ Переводы >= 100 тыс. $ в состоянии FirstStageFunding - бонус 100%, перевод 100 тыс. $ (264ms)
  √ Выкуп всех токенов первой стадии и проверка того, что достигнут Soft Cap (273ms)
  √ Перевели время на 12 дней вперед
  √ Состояние, после изменения времени на 12 дней вперед, должно быть FirstStageEnd
  √ Финализатор первой стадии должен сработать успешно (87ms)
  √ Состояние, после выполнения финализатора первой стадии, переменная isFirstStageFinalized должа быть = true (107ms)
  √ Переводы в состоянии FirstStageEnd не должны работать, перевод 26 тыс. $
  √ На балансе контракта AllocatedRefundableCappedCrowdsale после финализации первой стадии, всего должно находится 229737610 токенов
  √ На балансе контракта AllocatedRefundableCappedCrowdsale на второй стадии, должно находится 168857144 токенов для продажи (67ms)
  √ Перевели время на 30 дней вперед
  √ Состояние, после изменения времени на 30 дней вперед, должно быть SecondStageEnd (45ms)
  √ Финализатор второй стадии должен сработать успешно (182ms)
  √ Состояние, после выполнения финализатора второй стадии, при достижении Soft Cap должно быть Success, переменная isSecondStageFinalized должа быть = true, также isSuccessOver = true (59ms)
  √ На аккаунте советников должно быть 8040817 токенов
  √ На аккаунте маркетинга должно быть 3446064 токенов
  √ На аккаунте поддержки должно быть 3446064 токенов
  √ На аккаунте команды должно быть 0 токенов, т.к. они заблокированы до определенной даты
  √ При запросе токенов на аккаунт команды должна возникать ошибка (43ms)
  √ Перевели время на 365 дней вперед
  √ При запросе токенов на аккаунт команды не должно возникать ошибки (62ms)
  √ На аккаунте команды должно быть 45947521 токенов

  54 passing (4s)  
  